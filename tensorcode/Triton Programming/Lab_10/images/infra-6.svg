<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 550 280">
  <!-- White background -->
  <rect width="100%" height="100%" fill="white"/>

  <!-- Title -->
  <text x="275" y="25" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">Fusing Transpose with Operations</text>
  <text x="275" y="45" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">Often you can avoid explicit transpose by adjusting strides</text>

  <!-- Separate operations (bad) -->
  <g transform="translate(30, 70)">
    <text x="110" y="0" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#cc0000">Separate Operations (Slow)</text>

    <rect x="0" y="20" width="60" height="40" fill="#cce5ff" stroke="#0066cc" stroke-width="1.5" rx="3"/>
    <text x="30" y="45" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">A</text>

    <line x1="65" y1="40" x2="85" y2="40" stroke="#333" stroke-width="1.5" marker-end="url(#ar)"/>

    <rect x="90" y="20" width="60" height="40" fill="#ffeeee" stroke="#cc0000" stroke-width="1.5" rx="3"/>
    <text x="120" y="38" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">transpose</text>
    <text x="120" y="50" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">kernel</text>

    <line x1="155" y1="40" x2="175" y2="40" stroke="#333" stroke-width="1.5" marker-end="url(#ar)"/>

    <rect x="180" y="20" width="40" height="40" fill="#fff9e6" stroke="#cc9900" stroke-width="1.5" rx="3"/>
    <text x="200" y="45" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Aáµ€</text>

    <text x="110" y="80" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#cc0000">Extra memory read + write!</text>
  </g>

  <!-- Fused operation (good) -->
  <g transform="translate(290, 70)">
    <text x="110" y="0" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#006600">Fused with Strides (Fast)</text>

    <rect x="0" y="20" width="60" height="40" fill="#cce5ff" stroke="#0066cc" stroke-width="1.5" rx="3"/>
    <text x="30" y="45" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">A</text>

    <line x1="65" y1="40" x2="85" y2="40" stroke="#333" stroke-width="1.5" marker-end="url(#ar)"/>

    <rect x="90" y="15" width="130" height="50" fill="#e6ffe6" stroke="#006600" stroke-width="1.5" rx="3"/>
    <text x="155" y="35" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">matmul kernel</text>
    <text x="155" y="50" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#006600">(swapped strides for B)</text>

    <text x="110" y="80" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#006600">No separate transpose needed!</text>
  </g>

  <!-- Code example -->
  <g transform="translate(50, 160)">
    <rect x="0" y="0" width="450" height="100" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
    <text x="225" y="18" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">Instead of Explicit Transpose</text>

    <text x="15" y="40" font-family="monospace" font-size="8" fill="#cc0000"># Slow: explicit transpose</text>
    <text x="15" y="53" font-family="monospace" font-size="8" fill="#333">B_T = transpose(B)</text>
    <text x="15" y="66" font-family="monospace" font-size="8" fill="#333">C = matmul(A, B_T)</text>

    <text x="240" y="40" font-family="monospace" font-size="8" fill="#006600"># Fast: swap strides</text>
    <text x="240" y="53" font-family="monospace" font-size="8" fill="#333">C = matmul_transposed_b(</text>
    <text x="240" y="66" font-family="monospace" font-size="8" fill="#333">    A, B,</text>
    <text x="240" y="79" font-family="monospace" font-size="8" fill="#333">    stride_bk=B.stride(1),</text>
    <text x="240" y="92" font-family="monospace" font-size="8" fill="#333">    stride_bn=B.stride(0))</text>
  </g>

  <!-- Arrow marker -->
  <defs>
    <marker id="ar" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#333"/>
    </marker>
  </defs>
</svg>
