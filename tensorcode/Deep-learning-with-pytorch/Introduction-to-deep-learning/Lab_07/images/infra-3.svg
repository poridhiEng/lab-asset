<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 380">
  <rect width="900" height="380" fill="white"/>

  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Cross-Entropy Loss for Classification
  </text>

  <text x="450" y="58" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#7f8c8d">
    Measures difference between predicted probabilities and true labels
  </text>

  <!-- Main container -->
  <rect x="50" y="75" width="800" height="180" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="10"/>

  <!-- Raw scores -->
  <g>
    <rect x="80" y="100" width="150" height="90" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="8"/>
    <text x="155" y="125" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#e65100">Raw Scores</text>
    <text x="155" y="145" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#555">(Network output)</text>
    <text x="155" y="170" font-family="Monaco, monospace" font-size="12" text-anchor="middle" fill="#e65100">[2.0, 1.0, 0.5]</text>
  </g>

  <!-- Arrow -->
  <path d="M 240 145 L 280 145" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrowCE)"/>

  <!-- CrossEntropyLoss -->
  <g>
    <rect x="290" y="100" width="180" height="120" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="8"/>
    <text x="380" y="125" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#6a1b9a">CrossEntropyLoss</text>

    <rect x="310" y="140" width="140" height="30" fill="#9c27b0" stroke="#6a1b9a" stroke-width="1" rx="3"/>
    <text x="380" y="160" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Softmax + NLL Loss</text>

    <text x="380" y="195" font-family="Monaco, monospace" font-size="9" text-anchor="middle" fill="#555">nn.CrossEntropyLoss()</text>
  </g>

  <!-- Arrow -->
  <path d="M 480 145 L 520 145" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrowCE)"/>

  <!-- True label input -->
  <g>
    <rect x="530" y="100" width="130" height="90" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="8"/>
    <text x="595" y="125" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#1565c0">True Label</text>
    <text x="595" y="145" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#555">(Class index)</text>
    <text x="595" y="170" font-family="Monaco, monospace" font-size="12" text-anchor="middle" fill="#1565c0">1 (Mammal)</text>
  </g>

  <!-- Arrow -->
  <path d="M 670 145 L 710 145" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrowCE)"/>

  <!-- Loss output -->
  <g>
    <rect x="720" y="100" width="110" height="90" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="8"/>
    <text x="775" y="125" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2e7d32">Loss</text>
    <text x="775" y="155" font-family="Monaco, monospace" font-size="18" font-weight="bold" text-anchor="middle" fill="#2e7d32">0.42</text>
    <text x="775" y="175" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#555">Single float</text>
  </g>

  <!-- Note box -->
  <rect x="100" y="275" width="350" height="85" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="8"/>
  <text x="275" y="300" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#e65100">Important Note</text>
  <text x="275" y="320" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#555">nn.CrossEntropyLoss() expects:</text>
  <text x="275" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#555">• Raw scores (NOT softmax probabilities)</text>
  <text x="275" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#555">• Class index (NOT one-hot encoded)</text>

  <!-- Code example -->
  <rect x="480" y="275" width="350" height="85" fill="#ecf0f1" stroke="#95a5a6" stroke-width="2" rx="8"/>
  <text x="655" y="300" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2c3e50">PyTorch Code</text>
  <text x="655" y="325" font-family="Monaco, monospace" font-size="10" text-anchor="middle" fill="#555">criterion = nn.CrossEntropyLoss()</text>
  <text x="655" y="345" font-family="Monaco, monospace" font-size="10" text-anchor="middle" fill="#555">loss = criterion(scores, target)</text>

  <defs>
    <marker id="arrowCE" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#34495e"/>
    </marker>
  </defs>
</svg>
