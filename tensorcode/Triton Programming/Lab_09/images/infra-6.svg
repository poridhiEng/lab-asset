<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 550 280">
  <!-- White background -->
  <rect width="100%" height="100%" fill="white"/>

  <!-- Title -->
  <text x="275" y="25" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">Softmax Patterns in Triton</text>
  <text x="275" y="42" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">Common implementations for different use cases</text>

  <!-- Pattern 1: Standard Softmax -->
  <g transform="translate(30, 65)">
    <rect x="0" y="0" width="240" height="90" fill="#e6f3ff" stroke="#0066cc" stroke-width="1" rx="5"/>
    <text x="120" y="18" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#0066cc">Standard Softmax</text>
    <text x="10" y="38" font-family="monospace" font-size="8" fill="#333">m = tl.max(x, axis=0)</text>
    <text x="10" y="52" font-family="monospace" font-size="8" fill="#333">num = tl.exp(x - m)</text>
    <text x="10" y="66" font-family="monospace" font-size="8" fill="#333">den = tl.sum(num, axis=0)</text>
    <text x="10" y="80" font-family="monospace" font-size="8" fill="#006600">out = num / den</text>
  </g>

  <!-- Pattern 2: Log Softmax -->
  <g transform="translate(290, 65)">
    <rect x="0" y="0" width="240" height="90" fill="#fff9e6" stroke="#cc9900" stroke-width="1" rx="5"/>
    <text x="120" y="18" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#cc9900">Log Softmax</text>
    <text x="10" y="38" font-family="monospace" font-size="8" fill="#333">m = tl.max(x, axis=0)</text>
    <text x="10" y="52" font-family="monospace" font-size="8" fill="#333">shifted = x - m</text>
    <text x="10" y="66" font-family="monospace" font-size="8" fill="#333">lse = tl.log(tl.sum(tl.exp(shifted)))</text>
    <text x="10" y="80" font-family="monospace" font-size="8" fill="#006600">out = shifted - lse</text>
  </g>

  <!-- Pattern 3: Temperature Softmax -->
  <g transform="translate(30, 170)">
    <rect x="0" y="0" width="240" height="90" fill="#e6ffe6" stroke="#006600" stroke-width="1" rx="5"/>
    <text x="120" y="18" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#006600">Temperature Softmax</text>
    <text x="10" y="38" font-family="monospace" font-size="8" fill="#333">x_scaled = x / temperature</text>
    <text x="10" y="52" font-family="monospace" font-size="8" fill="#333">m = tl.max(x_scaled, axis=0)</text>
    <text x="10" y="66" font-family="monospace" font-size="8" fill="#333">num = tl.exp(x_scaled - m)</text>
    <text x="10" y="80" font-family="monospace" font-size="8" fill="#006600">out = num / tl.sum(num)</text>
  </g>

  <!-- Pattern 4: Masked Softmax -->
  <g transform="translate(290, 170)">
    <rect x="0" y="0" width="240" height="90" fill="#ffeeee" stroke="#cc0000" stroke-width="1" rx="5"/>
    <text x="120" y="18" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#cc0000">Masked Softmax (Attention)</text>
    <text x="10" y="38" font-family="monospace" font-size="8" fill="#cc0000"># mask = True where valid</text>
    <text x="10" y="52" font-family="monospace" font-size="8" fill="#333">x = tl.where(mask, x, -inf)</text>
    <text x="10" y="66" font-family="monospace" font-size="8" fill="#333">m = tl.max(x, axis=0)</text>
    <text x="10" y="80" font-family="monospace" font-size="8" fill="#006600"># then standard softmax...</text>
  </g>
</svg>
